!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t["aws-sig"]=e()}(this,function(){"use strict";var n=Object.create||function(){function n(){}return function(t){var e;return n.prototype=t,e=new n,n.prototype=null,e}}(),t={},e=t.lib={},r=e.Base={extend:function(t){var e=n(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),(e.init.prototype=e).$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},h=e.WordArray=r.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||o).stringify(this)},concat:function(t){var e=this.words,n=t.words,r=this.sigBytes,i=t.sigBytes;if(this.clamp(),r%4)for(var o=0;o<i;o++){var s=n[o>>>2]>>>24-o%4*8&255;e[r+o>>>2]|=s<<24-(r+o)%4*8}else for(o=0;o<i;o+=4)e[r+o>>>2]=n[o>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,e=this.sigBytes;t[e>>>2]&=4294967295<<32-e%4*8,t.length=Math.ceil(e/4)},clone:function(){var t=r.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e,n=[],r=function(e){e=e;var n=987654321,r=4294967295;return function(){var t=((n=36969*(65535&n)+(n>>16)&r)<<16)+(e=18e3*(65535&e)+(e>>16)&r)&r;return t/=4294967296,(t+=.5)*(.5<Math.random()?1:-1)}},i=0;i<t;i+=4){var o=r(4294967296*(e||Math.random()));e=987654071*o(),n.push(4294967296*o()|0)}return new h.init(n,t)}}),i=t.enc={},o=i.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],i=0;i<n;i++){var o=e[i>>>2]>>>24-i%4*8&255;r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r+=2)n[r>>>3]|=parseInt(t.substr(r,2),16)<<24-r%8*4;return new h.init(n,e/2)}},s=i.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],i=0;i<n;i++){var o=e[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(o))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r++)n[r>>>2]|=(255&t.charCodeAt(r))<<24-r%4*8;return new h.init(n,e)}},a=i.Utf8={stringify:function(t){try{return decodeURIComponent(escape(s.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return s.parse(unescape(encodeURIComponent(t)))}},c=e.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new h.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=a.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){var e=this._data,n=e.words,r=e.sigBytes,i=this.blockSize,o=r/(4*i),s=(o=t?Math.ceil(o):Math.max((0|o)-this._minBufferSize,0))*i,a=Math.min(4*s,r);if(s){for(var c=0;c<s;c+=i)this._doProcessBlock(n,c);var u=n.splice(0,s);e.sigBytes-=a}return new h.init(u,a)},clone:function(){var t=r.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),u=(e.Hasher=c.extend({cfg:r.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){c.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(n){return function(t,e){return new n.init(e).finalize(t)}},_createHmacHelper:function(n){return function(t,e){return new u.HMAC.init(n,e).finalize(t)}}}),t.algo={}),f=t,l=f.lib.Base,d=f.enc.Utf8,p=(f.algo.HMAC=l.extend({init:function(t,e){t=this._hasher=new t.init,"string"==typeof e&&(e=d.parse(e));var n=t.blockSize,r=4*n;e.sigBytes>r&&(e=t.finalize(e)),e.clamp();for(var i=this._oKey=e.clone(),o=this._iKey=e.clone(),s=i.words,a=o.words,c=0;c<n;c++)s[c]^=1549556828,a[c]^=909522486;i.sigBytes=o.sigBytes=r,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher,n=e.finalize(t);return e.reset(),e.finalize(this._oKey.clone().concat(n))}}),t),g=p.lib,y=g.WordArray,v=g.Hasher,w=p.algo,_=[],m=[];!function(){function t(t){for(var e=Math.sqrt(t),n=2;n<=e;n++)if(!(t%n))return!1;return!0}function e(t){return 4294967296*(t-(0|t))|0}for(var n=2,r=0;r<64;)t(n)&&(r<8&&(_[r]=e(Math.pow(n,.5))),m[r]=e(Math.pow(n,1/3)),r++),n++}();var B=[],S=w.SHA256=v.extend({_doReset:function(){this._hash=new y.init(_.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],c=n[5],u=n[6],h=n[7],f=0;f<64;f++){if(f<16)B[f]=0|t[e+f];else{var l=B[f-15],d=(l<<25|l>>>7)^(l<<14|l>>>18)^l>>>3,p=B[f-2],g=(p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10;B[f]=d+B[f-7]+g+B[f-16]}var y=r&i^r&o^i&o,v=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),w=h+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&c^~a&u)+m[f]+B[f];h=u,u=c,c=a,a=s+w|0,s=o,o=i,i=r,r=w+(v+y)|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0,n[5]=n[5]+c|0,n[6]=n[6]+u|0,n[7]=n[7]+h|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,r=8*t.sigBytes;return e[r>>>5]|=128<<24-r%32,e[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),e[15+(r+64>>>9<<4)]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=v.clone.call(this);return t._hash=this._hash.clone(),t}}),A=v._createHelper(S),j=v._createHmacHelper(S),U=function(t){return A(t).toString()},q=j,z=function(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})},H=function(t,e){return t.localeCompare(e)};var M=function(t){return t.toString().trim().replace(/\s+/g," ")},b=function(t){return t.length?t.map(function(t){var e=t[0],n=t[1];return e+":"+(Array.isArray(n)?n.map(M).join(","):M(n))}).join("\n"):""},K=function(t){return t.map(function(t){return t[0]}).join(";")},x=/\/\/+/g;function T(t){var e,n,r,i,o,s=t.method,a=t.body,c=t.sortedHeaders;return[s?s.toUpperCase():"GET",(o=t,o.url.pathname.replace(x,"/").split("/").reduce(function(t,e){return".."===e?t.pop():"."===e||t.push(e),t},[]).join("/")),(e=t,n=e.url,r={},i=[],n.searchParams.forEach(function(t,e){r[e]||(r[e]=[]),r[e].push(t)}),Object.keys(r).sort(H).forEach(function(e){r[e].sort(H).forEach(function(t){i.push(z(e)+"="+z(t))})}),i.join("&")),b(c),"",K(c),U("string"==typeof a?a.trim():a)].join("\n")}var P=/[:\-]|\.\d{3}/g,R=["url"],W=["accessKeyId","region","secretAccessKey","service"];return function(t,e){!function(e,n){if(!e)throw new Error("Missing request object");if(!n)throw new Error("Missing config object");var t=R.filter(function(t){return!e[t]});if(t.length)throw new Error("Missing required request fields: "+t.join(", "));if((t=W.filter(function(t){return!n[t]})).length)throw new Error("Missing required config fields: "+t.join(", "))}(t,e);var n,r,i,o,s,a,c,u,h,f,l,d,p,g,y,v,w,_,m,B,S,A,j,z,H,M,b,x,C,k=Object.assign(Object.create(null),{method:"GET"},t,e,{url:new URL(t.url),algorithm:"AWS4-HMAC-SHA256",date:(i=t,o=i.headers,s="X-Amz-Date"in o?o["X-Amz-Date"]:new Date(o.Date||Date.now()).toISOString().replace(P,""),{short:s.split("T")[0],long:s}),sortedHeaders:(n=t,r=n.headers,void 0===r&&(r={}),Object.keys(r).map(function(t){return[t.toLowerCase(),r[t]]}).sort(function(t,e){return t[0]>e[0]}))}),E=T(k),D=(c=E,u=(a=k).algorithm,h=a.date,f=a.region,l=a.service,[u,h.long,h.short+"/"+f+"/"+l+"/aws4_request",U(c)].join("\n")),I=(p=D,g=(d=k).date,y=d.secretAccessKey,v=d.region,w=d.service,_=q(g.short,"AWS4"+y),m=q(v,_),B=q(w,m),S=q("aws4_request",B),q(p,S)),O=(j=I,z=(A=k).algorithm,H=A.accessKeyId,M=A.date,b=A.region,x=A.service,C=A.sortedHeaders,[z+" Credential="+H+"/"+M.short+"/"+b+"/"+x+"/aws4_request","SignedHeaders="+K(C),"Signature="+j].join(", "));return t.headers||(t.headers={}),t.headers["X-Amz-Date"]=k.date.long,e.sessionToken&&(t.headers["X-Amz-Security-Token"]=e.sessionToken),t.headers.Authorization=O,t}});
//# sourceMappingURL=aws-sig.umd.js.map
